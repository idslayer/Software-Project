input {
  kafka {
#     bootstrap_servers => "10.8.0.7:31442"
    bootstrap_servers => "kafka:9092"
    topics => ["sample_producer.norm.log"]
    group_id => "logstash-group"
    auto_offset_reset => "earliest"
    codec => "json"
  }
}
filter {
  date {
    match => ["ts", "ISO8601"]
    target => "@timestamp"
  }
  mutate {
    add_field => {
       "ingested_at" => "%{@timestamp}"
       "logstash_host" => "%{host}"
     }
  }
}

output {
  elasticsearch {
    hosts => ["http://54.151.168.9:9200"]
    # index => "my-index-%{+YYYY.MM.dd}"
    index => "norm-logs-%{+YYYY.MM.dd}"
    user => "elastic"
    password => "NUi9rjIEzaRxlXuVAZy8"

    template => "/etc/logstash/templates/norm-logs.json"
    template_name => "norm-logs"
    template_overwrite => true
  }
  stdout {
    codec => rubydebug
   }
}
